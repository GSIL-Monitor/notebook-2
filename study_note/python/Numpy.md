# 1. python数据分析基础-Numpy
## 1.1 numpy介绍
- NumPy（Numerical Python的缩写）是一个开源的Python科学计算库
- 使用NumPy，就可以很自然地使用数组和矩阵。 NumPy包含很多实用的数学函数，涵盖线性代数运算、傅里叶变换和随机数生成等功能。
- NumPy能够直接对数组和矩阵进行操作，可以省略很多循环语句，其众多的数学函数也会让编写代码的工作轻松许多。
- NumPy的大部分代码都是用C语言写成的，这使得NumPy比纯Python代码高效得多。 
- 在 Windows 上安装 NumPy、 Matplotlib、SciPy 和 IPython
  - (1) 从SourceForge网站下载NumPy的Windows安装程序：
    http://sourceforge.net/projects/numpy/files/
    请选择合适的版本。在上图中，我们选择了numpy-1.7.0-win32-superpack-python2.7.exe。
  - (2) 下载完成后，双击运行安装程序。
    SciPy和Matplotlib可以通过Enthough安装，地址为www.enthought.com/products/epd.php。
    在安装过程中，你可能需要将一个文件msvcp71.dll放到目录C:\Windows\system32下。
    你可以从这里下载这个文件： www.dll-files.com/dllindex/dll-files.shtml?msvcp71。 
    Windows下的IPython安装程序可以通过访问IPython的官网下载： http://ipython.scipy.org/Wiki/IpythonOnWindows。
- 在 Linux 上安装 NumPy、 Matplotlib、 SciPy和 IPython
  - (1) 要在Red Hat上安装NumPy，请在命令行中执行如下命令：
    `yum install python-numpy`
- numpy简单使用
  ```
  import numpy as np
  a = np.arange(n) ** 2
  b = np.arange(n) ** 3
  c = a + b
  ```

## 1.2 NumPy 数组对象
### 1.2.1 多维数组
- NumPy中的ndarray是一个多维数组对象，该对象由两部分组成：
  - 实际的数据；
  - 描述这些数据的元数据。
    大部分的数组操作仅仅修改元数据部分，而不改变底层的实际数据

- 使用arange函数创建的数组只是包含一组数字的一维数组，而ndarray支持更高的维度。
- NumPy数组一般是同质的，即数组中的所有元素类型必须是一致的。
- 与Python中一样， NumPy数组的下标也是从0开始的。
  ```
  m = array([arange(2), arange(2)]) # array([[0, 1],[0, 1]])
  m.shape #(2, 2)

  #选取数组元素
  a = array([[1,2],[3,4]]) #array([[1, 2],[3, 4]])
  a[0,1] #2
  ```

### 1.2.2 数据类型：

| 类 型                | 描 述                      |
| ------------------ | ------------------------ |
| bool               | 用一位存储的布尔类型（值为TRUE或FALSE） |
| inti               | 由所在平台决定其精度的整数（一般为int32或i |
| int8               | 整数，范围为128至127           |
| int16              | 整数，范围为32 768至32 767     |
| int32              | 整数，范围为231至231 1        |
| int64              | 整数，范围为263至263 1        |
| uint8              | 无符号整数，范围为0至255           |
| uint16             | 无符号整数，范围为0至65 535        |
| uint32             | 无符号整数，范围为0至2321         |
| uint64             | 无符号整数，范围为0至2641         |
| float16            | 半精度浮点数（16位）：其中用1位表示正负号，  |
| float32            | 单精度浮点数（32位）：其中用1位表示正负号，  |
| float64或float      | 双精度浮点数（64位）：其中用1位表示正负号，  |
| complex64          | 复数，分别用两个32位浮点数表示实部和虚部    |
| complex128或complex | 复数，分别用两个64位浮点数表示实部和虚部    |

- 在NumPy中，许多函数的参数中可以指定数据类型，通常这个参数是可选的：
  `arange(7, dtype=uint16) #array([0, 1, 2, 3, 4, 5, 6], dtype=uint16)`

- 数据类型对象可以给出单个数组元素在内存中占用的字节数，即dtype类的itemsize属性：
  `a.dtype.itemsize #8`

### 1.2.3 字符编码
| 数据类型       | 字符编码 |
| ---------- | ---- |
| 整数         | i    |
| 无符号整数      | u    |
| 单精度浮点数     | f    |
| 双精度浮点数     | d    |
| 布尔值        | b    |
| 复数         | D    |
| 字符串        | S    |
| unicode字符串 | U    |
| void （空）   | V    |

- 下面的代码创建了一个单精度浮点数数组：
```
In: arange(7, dtype='f')
Out: array([ 0., 1., 2., 3., 4., 5., 6.], dtype=float32)
```
- 与此类似，还可以创建一个复数数组：
```
In: arange(7, dtype='D')
Out: array([ 0.+0.j, 1.+0.j, 2.+0.j, 3.+0.j, 4.+0.j, 5.+0.j, 6.+0.j])
```

### 1.2.4 一维数组的索引和切片
- 取3~6
```
In: a = arange(9)
In: a[3:7]
Out: array([3, 4, 5, 6])
```
- 也可以用下标0~7，以2为步长选取元素：
```
In: a[:7:2]
Out: array([0, 2, 4, 6])
```
- 和Python中一样，我们也可以利用负数下标翻转数组：
```
In: a[::-1]
Out: array([8, 7, 6, 5, 4, 3, 2, 1, 0])
```
- 用arange函数创建一个数组并改变其维度，使之变成一个三维数组：
- ndarray支持在多维数组上的切片操作。为了方便起见，我们可以用一个省略号（...）来表示遍历剩下的维度。
- reshape函数的作用是改变数组的“形状”，也就是改变数组的维度，其参数为一个正整数元组，分别指定数组在每个维度上的大小。如果指定的维度和数组的元素数目不相吻合，函数将抛出异常。
  ```
  In: b = arange(24).reshape(2,3,4)
  In: b.shape
  Out: (2, 3, 4)
  In: b
  Out:array([
  			[[ 0, 1, 2, 3],[ 4, 5, 6, 7],[ 8, 9,10,11]],
  			[[12, 13, 14, 15],[16, 17, 18, 19],[20, 21, 22, 23]]
  		])
  ```

- 元素选取
  ```
  In: b[0,0,0]
  Out: 0

  b[:,0,0]
  b[0, :, :]
  #多个冒号可以用一个省略号（...）来代替，因此上面的代码等价于：
  b[0, ...]

  b[0,1] #array([4, 5, 6, 7])
  #在上面的数组切片中间隔地选定元素：
  b[0,1,::2] #array([4, 6])
  b[...,1] #array([[ 1, 5, 9],[13,17,21]])
  b[:,1] #array([[ 4, 5, 6, 7],[16,17,18,19]])
  b[0,:,1] #array([1, 5, 9])
  #第1层楼的最后一列的所有房间
  b[0,:,-1] #array([ 3, 7, 11])
  #反向选取第1层楼的最后一列的所有
  b[0,::-1, -1] #array([11, 7, 3])
  #在该数组切片中间隔地选定元素：
  b[0,::2,-1] #array([ 3, 11])
  #在多维数组中执行翻转一维数组
  b[::-1] #array([[[12,13,14,15],[16,17,18,19],[20,21,22,23],
  			[[ 0, 1, 2, 3],[ 4, 5, 6, 7],[ 8, 9,10,11]]])
  ```

### 1.2.5 改变数组的维度
- ravel 我们可以用ravel函数完成展平的操作：
  ```
  b #array([[[ 0, 1, 2, 3],[ 4, 5, 6, 7],[ 8, 9,10,11]],
  		[[12,13,14,15],[16,17,18,19],[20,21,22,23]]])
  b.ravel() #array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,17, 18, 19, 20, 21, 22, 23])
  ```
- flatten 这个函数恰如其名， flatten就是展平的意思，与ravel函数的功能相同。不过，flatten函数会请求分配内存来保存结果，而ravel函数只是返回数组的一个视图（view）：
  ```
  b.flatten() #array([ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,17, 18, 19, 20, 21, 22, 23])
  ```
- 用元组设置维度 除了可以使用reshape函数，我们也可以直接用一个正整数元组来设置数组的维度
  ```
  b.shape = (6,4) #array([ 0, 1, 2, 3],[ 4, 5, 6, 7],[ 8, 9,10,11],[12,13,14,15],[16,17,18,19],[20,21,22,23]],
  ```
- transpose 在线性代数中， 转置矩阵是很常见的操作。
  ```
  b.transpose() #array([[ 0, 4, 8, 12, 16, 20],[ 1, 5, 9, 13, 17, 21],[ 2, 6,10, 14, 18, 22],[ 3, 7,11, 15, 19, 23]])
  ```
- resize resize和reshape函数的功能一样，但resize会直接修改所操作的数组：
  ```
  b.resize((2,12)) #array([[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11],[12,13,14,15,16,17,18,19,20,21, 22, 23]])
  ```

### 1.2.6 数组的组合
- NumPy数组有水平组合、垂直组合和深度组合等多种组合方式，我们将使用vstack、dstack、 hstack、 column_stack、 row_stack以及concatenate函数来完成数组的组合
  ```
  a = arange(9).reshape(3,3) # array([[0, 1, 2],[3, 4, 5],[6, 7, 8]])
  b = 2 * a # array([[ 0, 2, 4],[ 6, 8, 10],[12, 14,16]])
  ```

- 水平组合
  ```
  hstack((a, b)) #array([[ 0, 1, 2, 0, 2, 4],[ 3, 4, 5, 6, 8,10],[ 6, 7, 8,12,14,16]])
  #也可以用concatenate函数来实现同样的效果
  concatenate((a, b), axis=1) #array([[ 0, 1, 2, 0, 2, 4],[ 3, 4, 5, 6, 8,10],[ 6, 7, 8,12,14,16]])
  ```
  1
* 垂直组合

  ```
  vstack((a, b)) #array([[ 0, 1, 2],[ 3, 4, 5],[ 6, 7, 8],[ 0, 2, 4],[ 6, 8,10],[12,14,16]])
  # 我们将concatenate函数的axis参数设置为0即可实现同样的效果。这也是axis参数的默认值：
  concatenatel((a, b), axis = 0)
  ```


